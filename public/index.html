<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- dd -->
    <script src="https://gftruj.github.io/webzamples/aframe/controls/oculus-thumbstick-controls.js"></script>
  </head>
  <script>
    // AFRAME.registerComponent('modify-materials', {
    //   init: function () {
    //     // Wait for model to load.
    //     this.el.addEventListener('model-loaded', () => {
    //       // Grab the mesh / scene.
    //       const obj = this.el.getObject3D('mesh');
    //       // Go over the submeshes and modify materials we want.
    //       obj.traverse(node => {
    //         if (node.name.indexOf('ship') !== -1) {
    //           node.material.color.set('red');
    //         }
    //       });
    //     });
    //   }
    // });

    AFRAME.registerComponent('x-button-listener', {
  init: function () {
    var el = this.el;
    el.addEventListener('xbuttondown', function (evt) {
      console.log("ðŸš€ ~ file: index.html ~ line 29 ~ evt", evt)
      el.setAttribute('visible', !el.getAttribute('visible'));
    });
  }
});
  </script>
  <body>
    <a-scene>
    
    
    <!-- Adding all the assets -->
    <a-assets>
      <img id="sky" src="./sky.jpeg" />
      <a-asset-item
        id="mugblack"
        src="./mugblack.glb"
      ></a-asset-item>
      <a-asset-item
        id="gummy"
        src="./gummy.glb"
      ></a-asset-item>
      <a-asset-item
      id="cart"
      src="./cart.glb"
    ></a-asset-item>
    </a-assets>

    <!-- Adding Sky -->
    <a-sky src="#sky"></a-sky>

    <!-- Adding Camera -->
    <a-entity 
      id="rig"
      movement-controls
      tracked-controls="controller: 0; idPrefix: OpenVR"
    >
    
    <a-camera look-controls="enabled: true"    
    position="20 5 8"
    wasd-controls="enabled: true; acceleration:50" 
    rotation="35 180 0">
      <a-cursor></a-cursor>
      <!-- <a-entity cursor raycaster="far: 20; interval: 1000; objects: .clickable"></a-entity> -->
    </a-camera>
      <!-- Adding controller to oculus -->
      <!-- <a-entity laser-controls="hand: left" raycaster="objects: .clickable; lineColor: yellow; far: 50;" oculus-thumbstick-controls></a-entity>
      <a-entity laser-controls="hand: right" raycaster="objects: .clickable; lineColor: pink; far: 50;" oculus-thumbstick-controls></a-entity> -->

       <a-entity laser-controls="hand: left" raycaster="objects: .clickable; lineColor: yellow; far: 50;" oculus-thumbstick-controls id="leftHand" hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"></a-entity>
      <a-entity laser-controls="hand: right" raycaster="objects: .clickable; lineColor: pink; far: 50;" oculus-thumbstick-controls id="leftHand" hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc"></a-entity>
      <a-entity oculus-touch-controls x-button-listener></a-entity>
    </a-entity>

    <!-- SHELF -->
    <a-box
      position="7 2 0"
      width="5"
      height="5"
      depth="0.1"
      rotation="0 90 0"
    >
      <!-- top shelf -->
      <a-box
      width="5"
      depth="0.9"
      height="0.05"
      position="0 2 0.5"
      ></a-box>
      <a-box
      width="5"
      depth="0.9"
      height="0.05"
      position="0 1 0.5"
      >
    
    </a-box>

      <a-box
      width="5"
      depth="0.9"
      height="0.05"
      position="0 0 0.5"
      >
      <!-- Adding gummy bear -->
      <a-entity gltf-model="#gummy" background="color: red" position="0 0.38 0" rotation="0 -180 0" modify-materials></a-entity>
      <a-entity gltf-model="#gummy" color="#fff" position="2 0.38 0" rotation="0 -180 0"></a-entity>
      <a-entity gltf-model="#gummy" position="-2 0.38 0" rotation="0 -180 0"></a-entity>
      </a-box>
      <!-- bottom-shelf -->
      <a-box
      width="5"
      depth="0.9"
      height="0.05"
      position="0 -1 0.5"
      >
       <!-- Adding all the black bugs -->
       <a-entity gltf-model="#mugblack" position="0 -0.3 0" rotation="0 -35 0" scale="0.5 0.5 0.5"></a-entity>
       <a-entity gltf-model="#mugblack" position="2 -0.3 0" rotation="0 -35 0" scale="0.5 0.5 0.5"></a-entity>
       <a-entity gltf-model="#mugblack" position="-2 -0.3 0" rotation="0 -35 0" scale="0.5 0.5 0.5"></a-entity>

      </a-box>

      <a-entity gltf-model="#cart" position="-1 -2 3" rotation="0 -125 0" scale="1.5 1.5 1.5"></a-entity>
      
    </a-box>
     
  
      <!-- FLOOR -->
      <a-plane
      id="floor"
      height="30" 
      width="30" 
      position="10 0 0 "
      src="./floor.jpeg"
      rotation="-90 30 0"
      />
</a-scene>


    </a-scene>

    <script>
      let a = document.querySelector("a-entity")
      console.log("ðŸš€ ~ file: index.html ~ line 152 ~ a", a)
      a.addEventListener("ondrag", function () {
        a.setAttribute("scale", {
          x: 0.2,
          y: 2,
          z: 2.2
        })
      })
    </script>
  </body>
</html>

<!--  
1. pointer intractions(hover, click)
2. card for product details
3. animation of components(shelf-> front, front-> basket)(physics)
4. checkout
5. success animation or message.
. Hand tracking support
. Camera Movement
-->